---
title: Space Adventure
description: Multiple gesture demo with a space canvas
---

import SpaceAdventure from "../../../components/space-adventure.astro";

This demo uses `pinch()` from `@cereb/pinch` to implement zoom in/out on a space-themed canvas with stars and nebulae.

<SpaceAdventure />

## Code

```ts
import { wheel, keydown, keyheld, type KeyboardSignal, type WheelSignal, domEvent, type KeyboardValue } from "cereb";
import { zoom as createZoom, extend, when, spy, type ZoomInput, type ZoomOptions } from "cereb/operators";
import { pinch } from "@cereb/pinch";

const zoomMode$ = keyheld(window, { code: "KeyZ" }).pipe(extend((signal) => ({ opened: signal.value.held })));
const zoomModeIndicator = document.getElementById("space-zoom-mode");
const zoom = (options: ZoomOptions = {}) => createZoom({ minScale: MIN_SCALE, maxScale: MAX_SCALE, baseScale: () => zoomManager.getScale(), ...options });

zoomMode$.on((signal) => {
  zoomModeIndicator?.classList.toggle("active", signal.value.held);
});

// Pinch Zoom
pinch(box, { threshold: 10 })
  .pipe(zoom())
  .on(render);

// 'z' + '+/-' (logarithmic zoom: multiply by 1.2 or 1/1.2)
keydown(window, { code: ["Equal", "Minus"] })
  .pipe(
    when(zoomMode$),
    extend<KeyboardSignal, ZoomInput>((signal) => ({
      ratio: signal.value.code === "Equal" ? 1.2 : 1 / 1.2,
    })),
    zoom(),
  )
  .on(render);

// 'z' + 'wheel'
wheel(box, { passive: false })
  .pipe(
    when(zoomMode$),
    spy((signal) => signal.value.originalEvent.preventDefault()),
    extend<WheelSignal, ZoomInput>((signal) => ({
      ratio: Math.exp(-signal.value.deltaY * 0.005),
    })),
    zoom(),
  )
  .on(render);

// 'Progress' - slider sets absolute scale (baseScale=1 so ratio becomes the scale directly)
domEvent(slider, "input")
  .pipe(
    extend<DomEventSignal<Event>, ZoomInput>((signal) => {
      const inputElement = signal.value.target as HTMLInputElement;
      const value = Number(inputElement.value);
      const logScale = logMin + (value / 100) * (logMax - logMin);
      const scale = Math.exp(logScale);
      return {
        ratio: clamp(scale, MIN_SCALE, MAX_SCALE),
      };
    }),
    zoom({ baseScale: 1.0 }),
  )
  .on(render);
```
